<section class="content pt-4">
    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Datos de Contrato</h3>
                    </div>
                    <!-- /.card-header -->
                    <div class="card-body">
                        {% with messages = get_flashed_messages(with_categories=true) %}
                            {% if messages %}
                                {% for category, message in messages %}
                                    {% if category == 'error' %}
                                        <div class="alert alert-danger" role="alert">
                                            {{ message }}
                                        </div>
                                    {% endif %}
                                    {% if category == 'success' %}
                                        <div class="alert alert-success" role="alert">
                                            {{ message }}
                                        </div>
                                    {% endif %}
                                {% endfor %}
                            {% endif %}
                        {% endwith %}
                        <!-- form start -->
                        <form role="form" action="{{ url_for('contract_data.update') }}/{{ rut }}" method="POST">
                            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="exampleInputEmail1">Tipo de Contrato</label>
                                            <select class="form-control select2 select2-danger" data-dropdown-css-class="select2-danger" style="width: 100%;" name="contract_type_id">
                                                <option value="">- Seleccionar -</option>
                                                {% for contract_type in contract_types %}
                                                    <option {% if contract_type.id == contract_datum.contract_type_id %} selected {% endif %} value="{{ contract_type.id }}">{{ contract_type.contract_type }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="exampleInputEmail1">Sucursal</label>
                                            <select class="form-control select2 select2-danger" data-dropdown-css-class="select2-danger" style="width: 100%;" name="branch_office_id">
                                                <option value="">- Seleccionar -</option>
                                                {% for branch_office in branch_offices %}
                                                    <option {% if branch_office.id == contract_datum.branch_office_id %} selected {% endif %} value="{{ branch_office.id }}">{{ branch_office.branch_office }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="exampleInputEmail1">Region</label>
                                            <select class="form-control select2 select2-danger" data-dropdown-css-class="select2-danger" style="width: 100%;" name="region_id">
                                                <option value="">- Seleccionar -</option>
                                                {% for region in regions %}
                                                    <option {% if region.id == contract_datum.region_id %} selected {% endif %} value="{{ region.id }}">{{ region.region }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="exampleInputEmail1">Comuna</label>
                                            <select class="form-control select2 select2-danger" data-dropdown-css-class="select2-danger" style="width: 100%;" name="contract_type_id">
                                                <option value="">- Seleccionar -</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="exampleInputEmail1">Dirección</label>
                                            <input type="text" value="{{ contract_datum.address }}" class="form-control" id="exampleInputEmail1" placeholder="Dirección" name="address">
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="exampleInputEmail1">Estado Civil</label>
                                            <select class="form-control select2 select2-danger" data-dropdown-css-class="select2-danger" style="width: 100%;" name="civil_state_id">
                                                <option value="">- Seleccionar -</option>
                                                {% for civil_state in civil_states %}
                                                    <option {% if civil_state.id == contract_datum.civil_state_id %} selected {% endif %} value="{{ civil_state.id }}">{{ civil_state.civil_state }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="exampleInputEmail1">Isapre o Fonasa</label>
                                            <select class="form-control select2 select2-danger" data-dropdown-css-class="select2-danger" style="width: 100%;" name="health_id">
                                                <option value="">- Seleccionar -</option>
                                                {% for health in healths %}
                                                    <option {% if health.id == contract_datum.health_id %} selected {% endif %} value="{{ health.id }}">{{ health.health }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="exampleInputEmail1">AFP</label>
                                            <select class="form-control select2 select2-danger" data-dropdown-css-class="select2-danger" style="width: 100%;" name="pention_id">
                                                <option value="">- Seleccionar -</option>
                                                {% for pention in pentions %}
                                                    <option {% if pention.id == contract_datum.pention_id %} selected {% endif %} value="{{ pention.id }}">{{ pention.pention }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="exampleInputEmail1">Puesto Laboral</label>
                                            <select class="form-control select2 select2-danger" data-dropdown-css-class="select2-danger" style="width: 100%;" name="job_position_id">
                                                <option value="">- Seleccionar -</option>
                                                {% for job_position in job_positions %}
                                                    <option {% if job_position.id == contract_datum.job_position_id %} selected {% endif %} value="{{ job_position.id }}">{{ job_position.job_position }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="exampleInputEmail1">Fecha de Entrada</label>
                                            <input type="date" value="{{ contract_datum.entrance_company }}" class="form-control" id="exampleInputEmail1" placeholder="Fecha de Entrada" name="entrance_company">
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="exampleInputEmail1">Fecha de Salida</label>
                                            <input type="date" value="{{ contract_datum.exit_company }}" class="form-control" id="exampleInputEmail1" placeholder="Fecha de Salida" name="exit_company">
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="exampleInputEmail1">Salario</label>
                                            <input type="text" value="{{ contract_datum.salary }}" class="form-control" id="exampleInputEmail1" placeholder="Salario" name="salary">
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="exampleInputEmail1">Colación</label>
                                            <input type="text" value="{{ contract_datum.collation }}" class="form-control" id="exampleInputEmail1" placeholder="Colación" name="collation">
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="exampleInputEmail1">Movilización</label>
                                            <input type="text" value="{{ contract_datum.locomotion }}" class="form-control" id="exampleInputEmail1" placeholder="Movilización" name="locomotion">
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="exampleInputEmail1">Tipo de Empleado</label>
                                            <select class="form-control select2 select2-danger" data-dropdown-css-class="select2-danger" style="width: 100%;" name="employee_type_id">
                                                <option value="">- Seleccionar -</option>
                                                {% for employee_type in employee_types %}
                                                    <option {% if employee_type.id == contract_datum.employee_type_id %} selected {% endif %} value="{{ employee_type.id }}">{{ employee_type.employee_type }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <input type="hidden" value="{{ contract_datum.rut }}" class="form-control" id="exampleInputEmail1" name="rut">
                            
                            <!-- /.card-body -->

                            <div class="card-footer">
                                <button type="submit" class="btn btn-primary">Actualizar</button>

                                <a href="{{ url_for('employees.index') }}" class="btn btn-secondary">Cancelar</a>
                            </div>
                        </form>
                        <!-- form end -->
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <form role="form" action="{{ url_for('contract_data.generate') }}" method="POST">
                                Contratos
                                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
                                <button type="submit" class="btn btn-success">Crear</button>
                                <input type="hidden" name="rut" value="{{ rut }}">
                                <input type="hidden" name="document_type_id" value="21">
                                <input type="hidden" name="status_id" value="3">
                            </form>        
                        </h3>
                    </div>
                    <!-- /.card-header -->
                    <div class="card-body">
                        <table id="example2" class="table table-bordered table-hover">
                            <thead>
                                <tr>
                                    <th>Fecha</th>
                                    <th></th>
                                </tr>
                            </thead>
                            {% for contract_datum in contract_data %}
                                <tbody>
                                    <tr>
                                        <td>{{ contract_datum['added_date']|datetime("dd-MM-yyyy") }}</td>
                                        <td>
                                            {% if contract_datum['support'] is not none %}
                                                <a href="{{ url_for('contract_data.download', id=contract_datum['id']) }}" class="btn btn-success">
                                                    <i class="fa fa-arrow-down"></i>
                                                </a>
                                            {% else %}
                                                <a href="{{ url_for('contract_data.upload') }}/{{ contract_datum['id'] }}/{{ rut }}" class="btn btn-success">
                                                    <i class="fa fa-arrow-up"></i>
                                                </a>
                                            {% endif %}
                                            <a href="{{ url_for('contract_data.document', rut=rut, id=contract_datum['id']) }}" class="btn btn-primary">
                                                <i class="fa fa-file"></i>
                                            </a>
                                            <a href="{{ url_for('contract_data.delete', rut=rut, id=contract_datum['id']) }}" class="btn btn-danger">
                                                <i class="fa fa-times"></i>
                                            </a>
                                        </td>
                                    </tr>
                                </tbody>
                            {% endfor %}
                        </table>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            Finiquito
                            <a href="{{ url_for('end_documents.create') }}" class="btn btn-secondary">Crear</a>
                        </h3>
                    </div>
                    <!-- /.card-header -->
                    <div class="card-body">
                    <table id="example2" class="table table-bordered table-hover">
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th></th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
    </div>
</section>